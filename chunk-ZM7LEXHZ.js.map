{
  "version": 3,
  "sources": ["apps/findqo-ireland/src/app/feature/seller/seller.facade.ts"],
  "sourcesContent": ["import { HttpErrorResponse } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Params, Router } from '@angular/router';\nimport { APP_ROUTE } from '@core/constants';\nimport { AdsApi } from '@core/data-access/apis/ads.api';\nimport { SellerType } from '@core/enums';\nimport { GetAdListResponse, PageMetaData, Seller } from '@core/models';\nimport { AdsState } from '@shared/states/ads.state';\nimport { BehaviorSubject, Observable, catchError, finalize, of } from 'rxjs';\n\n@Injectable()\nexport class SellerFacade {\n\tconstructor(\n\t\tprivate readonly adsState: AdsState,\n\t\tprivate readonly adsApi: AdsApi,\n\t\tprivate readonly router: Router\n\t) {}\n\n\t/**\n\t * TODO: Move all declarations here to Seller State\n\t */\n\tprivate readonly _isLoading$ = new BehaviorSubject<boolean>(false);\n\tprivate readonly _isLoadingMoreAds$ = new BehaviorSubject<boolean>(false);\n\tprivate readonly _seller$ = new BehaviorSubject<Seller>(undefined);\n\n\tgetIsLoading$(): Observable<boolean> {\n\t\treturn this._isLoading$.asObservable();\n\t}\n\n\tgetIsLoadingMoreAds$(): Observable<boolean> {\n\t\treturn this._isLoadingMoreAds$.asObservable();\n\t}\n\n\tgetSeller$(): Observable<Seller> {\n\t\treturn this._seller$.asObservable();\n\t}\n\n\tgetSeller(): Seller {\n\t\treturn this._seller$.getValue();\n\t}\n\n\tgetMetadata(): PageMetaData {\n\t\treturn this.adsState.getPageMetaData();\n\t}\n\n\tsetIsLoading(isLoading: boolean): void {\n\t\tthis._isLoading$.next(isLoading);\n\t}\n\n\tsetIsLoadingMoreAds(isLoading: boolean): void {\n\t\tthis._isLoadingMoreAds$.next(isLoading);\n\t}\n\n\tsetSeller(seller: Seller): void {\n\t\tthis._seller$.next(seller);\n\t}\n\n\tclearData() {\n\t\tthis.adsState.setAdList([]);\n\t\tthis.setSeller(undefined);\n\t\tthis.adsState.setPageMetaData(undefined);\n\t\tthis.adsState.setAdListKind(undefined);\n\t}\n\t// end - Move all declarations here to Seller State\n\n\tloadAdList(params: { userId: string; sellerTypeId: string; sort: string; agentId: string }): void {\n\t\tthis.setIsLoading(true);\n\t\tthis.adsState.setIsLoading(true);\n\t\tlet adListVm$ = this.adsApi.getAdList(params);\n\n\t\tif (params?.agentId) {\n\t\t\tadListVm$ = this.adsApi.getAgentAdList(params?.agentId, { sort: params?.sort, sellerTypeId: SellerType.BUSINESS });\n\t\t}\n\n\t\tadListVm$\n\t\t\t.pipe(\n\t\t\t\tcatchError((response: HttpErrorResponse) => {\n\t\t\t\t\tif (response.status === 400 || response.status === 403) {\n\t\t\t\t\t\tthis.router.navigate([APP_ROUTE.wildCard], { skipLocationChange: true });\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow new Error(response.message);\n\t\t\t\t}),\n\t\t\t\tfinalize(() => {\n\t\t\t\t\tthis.setIsLoading(false);\n\t\t\t\t\tthis.adsState.setIsLoading(false);\n\t\t\t\t})\n\t\t\t)\n\t\t\t.subscribe((adListResponse: GetAdListResponse) => {\n\t\t\t\tthis.adsState.setAdList(adListResponse?.data);\n\t\t\t\tthis.setSeller(adListResponse?.seller);\n\t\t\t\tthis.adsState.setPageMetaData(adListResponse?.meta);\n\t\t\t\tthis.adsState.setAdListKind(adListResponse.kind);\n\t\t\t});\n\t}\n\n\tupdateAdsList(params: Params): void {\n\t\tthis.setIsLoadingMoreAds(true);\n\n\t\tthis.adsApi\n\t\t\t.getAdList({ ...params, userId: this.getSeller().id })\n\t\t\t.pipe(\n\t\t\t\tcatchError((response: HttpErrorResponse) => {\n\t\t\t\t\tif (response.status === 400) {\n\t\t\t\t\t\tthis.router.navigate([APP_ROUTE.wildCard], { skipLocationChange: true });\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow new Error(response.message);\n\t\t\t\t}),\n\t\t\t\tfinalize(() => {\n\t\t\t\t\tthis.setIsLoadingMoreAds(false);\n\t\t\t\t})\n\t\t\t)\n\t\t\t.subscribe((adListResponse: GetAdListResponse) => {\n\t\t\t\tthis.adsState.addDataToList(adListResponse?.data);\n\t\t\t\tthis.adsState.setPageMetaData(adListResponse?.meta);\n\t\t\t});\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAWM,IAAO,eAAP,MAAO,cAAY;EACxB,YACkB,UACA,QACA,QAAc;AAFd,SAAA,WAAA;AACA,SAAA,SAAA;AACA,SAAA,SAAA;AAMD,SAAA,cAAc,IAAI,gBAAyB,KAAK;AAChD,SAAA,qBAAqB,IAAI,gBAAyB,KAAK;AACvD,SAAA,WAAW,IAAI,gBAAwB,MAAS;EAP9D;EASH,gBAAa;AACZ,WAAO,KAAK,YAAY,aAAY;EACrC;EAEA,uBAAoB;AACnB,WAAO,KAAK,mBAAmB,aAAY;EAC5C;EAEA,aAAU;AACT,WAAO,KAAK,SAAS,aAAY;EAClC;EAEA,YAAS;AACR,WAAO,KAAK,SAAS,SAAQ;EAC9B;EAEA,cAAW;AACV,WAAO,KAAK,SAAS,gBAAe;EACrC;EAEA,aAAa,WAAkB;AAC9B,SAAK,YAAY,KAAK,SAAS;EAChC;EAEA,oBAAoB,WAAkB;AACrC,SAAK,mBAAmB,KAAK,SAAS;EACvC;EAEA,UAAU,QAAc;AACvB,SAAK,SAAS,KAAK,MAAM;EAC1B;EAEA,YAAS;AACR,SAAK,SAAS,UAAU,CAAA,CAAE;AAC1B,SAAK,UAAU,MAAS;AACxB,SAAK,SAAS,gBAAgB,MAAS;AACvC,SAAK,SAAS,cAAc,MAAS;EACtC;;EAGA,WAAW,QAA+E;AACzF,SAAK,aAAa,IAAI;AACtB,SAAK,SAAS,aAAa,IAAI;AAC/B,QAAI,YAAY,KAAK,OAAO,UAAU,MAAM;AAE5C,QAAI,QAAQ,SAAS;AACpB,kBAAY,KAAK,OAAO,eAAe,QAAQ,SAAS,EAAE,MAAM,QAAQ,MAAM,cAAc,WAAW,SAAQ,CAAE;IAClH;AAEA,cACE,KACA,WAAW,CAAC,aAA+B;AAC1C,UAAI,SAAS,WAAW,OAAO,SAAS,WAAW,KAAK;AACvD,aAAK,OAAO,SAAS,CAAC,UAAU,QAAQ,GAAG,EAAE,oBAAoB,KAAI,CAAE;MACxE;AAEA,YAAM,IAAI,MAAM,SAAS,OAAO;IACjC,CAAC,GACD,SAAS,MAAK;AACb,WAAK,aAAa,KAAK;AACvB,WAAK,SAAS,aAAa,KAAK;IACjC,CAAC,CAAC,EAEF,UAAU,CAAC,mBAAqC;AAChD,WAAK,SAAS,UAAU,gBAAgB,IAAI;AAC5C,WAAK,UAAU,gBAAgB,MAAM;AACrC,WAAK,SAAS,gBAAgB,gBAAgB,IAAI;AAClD,WAAK,SAAS,cAAc,eAAe,IAAI;IAChD,CAAC;EACH;EAEA,cAAc,QAAc;AAC3B,SAAK,oBAAoB,IAAI;AAE7B,SAAK,OACH,UAAU,iCAAK,SAAL,EAAa,QAAQ,KAAK,UAAS,EAAG,GAAE,EAAE,EACpD,KACA,WAAW,CAAC,aAA+B;AAC1C,UAAI,SAAS,WAAW,KAAK;AAC5B,aAAK,OAAO,SAAS,CAAC,UAAU,QAAQ,GAAG,EAAE,oBAAoB,KAAI,CAAE;MACxE;AAEA,YAAM,IAAI,MAAM,SAAS,OAAO;IACjC,CAAC,GACD,SAAS,MAAK;AACb,WAAK,oBAAoB,KAAK;IAC/B,CAAC,CAAC,EAEF,UAAU,CAAC,mBAAqC;AAChD,WAAK,SAAS,cAAc,gBAAgB,IAAI;AAChD,WAAK,SAAS,gBAAgB,gBAAgB,IAAI;IACnD,CAAC;EACH;;;uCA1GY,eAAY,mBAAA,QAAA,GAAA,mBAAA,MAAA,GAAA,mBAAA,MAAA,CAAA;IAAA;EAAA;;4EAAZ,eAAY,SAAZ,cAAY,UAAA,CAAA;EAAA;;;sEAAZ,cAAY,CAAA;UADxB;;;",
  "names": []
}
