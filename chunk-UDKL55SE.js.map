{
  "version": 3,
  "sources": ["apps/findqo-ireland/src/app/feature/ads/ads.facade.ts"],
  "sourcesContent": ["import { HttpErrorResponse } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Params, Router } from '@angular/router';\nimport { APP_ROUTE } from '@core/constants';\nimport { AdsApi } from '@core/data-access/apis/ads.api';\nimport { CommonFacade } from '@core/facades/common.facade';\nimport { GetAdListResponse } from '@core/models/ads.model';\nimport { AdsState } from '@shared/states/ads.state';\nimport { BehaviorSubject, Observable, catchError, finalize, tap } from 'rxjs';\n\n@Injectable()\nexport class AdsFacade {\n\tconstructor(\n\t\tprivate readonly adsApi: AdsApi,\n\t\tprivate readonly adsState: AdsState,\n\t\tprivate readonly router: Router,\n\t\tprivate readonly commonFacade: CommonFacade\n\t) {}\n\n\tprivate readonly _isLoadingMoreAds$ = new BehaviorSubject<boolean>(false);\n\n\tget isLoadingMoreAds$(): Observable<boolean> {\n\t\treturn this._isLoadingMoreAds$.asObservable();\n\t}\n\n\tupdateAdsList(params: Params): void {\n\t\tthis._isLoadingMoreAds$.next(true);\n\n\t\tthis.adsApi\n\t\t\t.getAdList(params)\n\t\t\t.pipe(finalize(() => this._isLoadingMoreAds$.next(false)))\n\t\t\t.subscribe((adListResponse: GetAdListResponse) => {\n\t\t\t\tthis.adsState.addAd(adListResponse?.data);\n\t\t\t\tthis.adsState.setPageMetaData(adListResponse?.meta);\n\t\t\t});\n\t}\n\n\tfetchAds(params: Params): Observable<GetAdListResponse> {\n\t\tthis.adsState.setIsLoading(true);\n\n\t\treturn this.adsApi.getAdList(params).pipe(\n\t\t\tcatchError((response: HttpErrorResponse) => {\n\t\t\t\tif (response.status === 400 || response.status === 500) {\n\t\t\t\t\tthis.router.navigate([APP_ROUTE.wildCard], { skipLocationChange: true });\n\t\t\t\t}\n\n\t\t\t\tthrow new Error(response.message);\n\t\t\t}),\n\t\t\ttap(() => this.commonFacade.fetchRecentSearch()),\n\t\t\tfinalize(() => this.adsState.setIsLoading(false))\n\t\t);\n\t}\n\n\tupdateAdsState(adListResponse: GetAdListResponse): void {\n\t\tthis.adsState.setAdList(adListResponse?.data);\n\t\tthis.adsState.setPageMetaData(adListResponse?.meta);\n\t\tthis.adsState.setAdListKind(adListResponse.kind);\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAWM,IAAO,YAAP,MAAO,WAAS;EACrB,YACkB,QACA,UACA,QACA,cAA0B;AAH1B,SAAA,SAAA;AACA,SAAA,WAAA;AACA,SAAA,SAAA;AACA,SAAA,eAAA;AAGD,SAAA,qBAAqB,IAAI,gBAAyB,KAAK;EAFrE;EAIH,IAAI,oBAAiB;AACpB,WAAO,KAAK,mBAAmB,aAAY;EAC5C;EAEA,cAAc,QAAc;AAC3B,SAAK,mBAAmB,KAAK,IAAI;AAEjC,SAAK,OACH,UAAU,MAAM,EAChB,KAAK,SAAS,MAAM,KAAK,mBAAmB,KAAK,KAAK,CAAC,CAAC,EACxD,UAAU,CAAC,mBAAqC;AAChD,WAAK,SAAS,MAAM,gBAAgB,IAAI;AACxC,WAAK,SAAS,gBAAgB,gBAAgB,IAAI;IACnD,CAAC;EACH;EAEA,SAAS,QAAc;AACtB,SAAK,SAAS,aAAa,IAAI;AAE/B,WAAO,KAAK,OAAO,UAAU,MAAM,EAAE,KACpC,WAAW,CAAC,aAA+B;AAC1C,UAAI,SAAS,WAAW,OAAO,SAAS,WAAW,KAAK;AACvD,aAAK,OAAO,SAAS,CAAC,UAAU,QAAQ,GAAG,EAAE,oBAAoB,KAAI,CAAE;MACxE;AAEA,YAAM,IAAI,MAAM,SAAS,OAAO;IACjC,CAAC,GACD,IAAI,MAAM,KAAK,aAAa,kBAAiB,CAAE,GAC/C,SAAS,MAAM,KAAK,SAAS,aAAa,KAAK,CAAC,CAAC;EAEnD;EAEA,eAAe,gBAAiC;AAC/C,SAAK,SAAS,UAAU,gBAAgB,IAAI;AAC5C,SAAK,SAAS,gBAAgB,gBAAgB,IAAI;AAClD,SAAK,SAAS,cAAc,eAAe,IAAI;EAChD;;;uCA9CY,YAAS,mBAAA,MAAA,GAAA,mBAAA,QAAA,GAAA,mBAAA,MAAA,GAAA,mBAAA,YAAA,CAAA;IAAA;EAAA;;4EAAT,YAAS,SAAT,WAAS,UAAA,CAAA;EAAA;;;sEAAT,WAAS,CAAA;UADrB;;;",
  "names": []
}
